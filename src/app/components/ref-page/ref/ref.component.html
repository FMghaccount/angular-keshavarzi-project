<div
  *ngIf="order?.cart?.length <= 0 && isLoading === true"
  class="container-fluid container-lg mb-5 mt-5"
>
  <div class="row justify-content-center align-items-center">
    <app-loading></app-loading>
  </div>
</div>

<div class="container-fluid container-md">
  <div
    *ngIf="order === null && ok === 'false' && isLoading === false"
    class="container border py-3 rounded-2 border-danger border-3 mb-4 mt-5"
  >
    <div
      class="row justify-content-center align-content-center align-items-center flex-column"
    >
      <h4 class="text-center text-danger">پرداختی صورت نگرفته است</h4>
      <p class="text-center py-4">
        <a routerLink="/cart" class="btn btn-outline-primary">سبد خرید</a>
      </p>
    </div>
  </div>
  <div class="container mt-4" *ngIf="order !== null && ok === 'true' && isLoading === false">
  <div class="row"><button (click)="downloadAsPDF()" class="btn w-25 btn-primary d-block float-end">دانلود فاکتور</button></div>
  </div>
  <div
    *ngIf="order !== null && ok === 'true' && isLoading === false"
    class="container mb-2 mt-4"
    #dataToExport
  >
    <div class="row mb-4 flex-row justify-content-between">
      <h4 class="text-right col-6">اقلام خریداری شده</h4>
      <h5 class="text-left date-time col-6">تاریخ و ساعت خرید: {{getInvoiceDate()}} </h5>
    </div>
    <div  class="row">
      <div
        class="card mb-3"
        *ngFor="let item of order?.cart.items; let i = index"
      >
        <div class="row g-0 py-3">
          <div class="col-12 col-sm-5">
            <a
              class="d-block text-center"
              [routerLink]="['/product', item.item.id]"
            >
              <img
                class="product-image py-2"
                height="200px"
                src="{{ item.item.images.split('---')[0] }}"
                alt="{{ item.item.images.split('|')[0] }}"
              />
            </a>
          </div>
          <div
            class="col-sm-7 col-12 d-flex flex-column justify-content-between align-items-center"
          >
            <div class="card-body p-0">
              <ul class="list-unstyled pe-0">
                <li class="mb-1">
                  کالا: {{ item.title.split("|").join(" - ") }}
                </li>
                <li class="mb-1">تعداد: {{ item.amount }}</li>
                <li class="mb-1">قیمت واحد: {{ item.price }} تومان</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <div
        class="card mb-3 d-flex flex-column align-items-center p-3 text-success flex-sm-row gap-3 justify-content-between bg-success-subtle"
        *ngIf="order !== null && ok === 'true' && isLoading === false"
      >
        <div class="d-flex justify-content-between gap-3">
          <div>مبلغ نهایی:</div>
          <div>{{ order?.cart.price }} تومان</div>
        </div>
      </div>
    </div>
  </div>
</div>
